server {
  listen   <%= @params[:port] %><%= @params[:default_server] ? ' default_server' : '' %>;
  server_name <%= @params[:server_name].nil? ? node['hostname'] : @params[:server_name] %>;

  access_log <%= node['nginx']['log_dir'] %>/<%= @params[:name] %>-access.log;
  error_log  <%= node['nginx']['log_dir'] %>/<%= @params[:name] %>-error.log;

  location / {
    root <%= @params[:docroot].nil? ? node['nginx']['default_root'] : @params[:docroot] %>;
    <% if @params[:directory_index] -%>
    index <%= [@params[:directory_index]].flatten.join " " %>;
    <% else -%>
    index index.html index.htm;
    <% end -%>
  }
}
